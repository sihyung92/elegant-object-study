# 2.8 모의 객체(Mock) 대신 페이크 객체(Fake)를 사용하세요

## 내용

Mock 객체를 통해서 테스트를 하는 경우 다음과 같은 문제들이 발생한다.

- 테스트가 장황하고 이해하기 어렵고 리팩토링하기 어려워진다.
  - 우선 Mock 객체에 대한 설정들을 테스트코드에서 해야한다.
- 가정을 사실로 만들어 버린다.
  - Mock 객체를 설정할 때, 내부에서 사용하는 메소드를 밖에 노출한다.
  - 때문에 어떤 메소드 A를 호출할 때 사용하는 감추어진 메소드를 알게 한다.
- 클래스의 행동이 변경되지 않았을 때에도 단위 테스트가 실패할 수 있다.

Mock 객체는 테스트에 우호적이지 않다.

어떠한 클래스 A에 대한 테스트를 작성할 때 우리의 관심사는 클래스 A와 우리의 상호작용이지 다른 클래스와의 상호작용이 아니다. 그러나 모의객체는 그러한 상호작용까지 알게하고 신경쓰게 하여 유지보수를 어렵게 한다. 또한 캡슐화를 깨뜨린다.

그러므로 테스트를 할 때는 Fake 객체를 사용하자.

```java
interface Exchange {
	float rate(String target);
	float rate(String origin, String target);

	final class Fake implement Exchange {
		@Override
		float rate(String target) {
			return this.rate("USD", target);
		}

		@Override
		float rate(Strin origin, String target) {
			return 1.2345;
		}
	}
}
```

## 의견

Mock 객체에 대한 의구심을 가져본적이 없는데 예고르가 제시한 문제점들을 처음 알게 되어서 한층 시야가 넓어진 것 같다.

이전에 예고르가 말했던 것처럼 테스트 코드를 프로덕션 코드와 함께 중요한 한 일부분으로 보고 객체지향의 아이디어들을 모두 적용하며 깔끔하게 함께 짜야할 코드로 보는 것이 느껴졌다.

다음에 Fake 객체를 적용해보고 싶다! 그렇게 하려면 이전에 나왔던 거의 모든 클래스에 대해서 인터페이스를 자연스럽게 생성하게 될 것 같다. 그리고 매우 귀찮겠지 ...