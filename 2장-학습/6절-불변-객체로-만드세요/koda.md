# 2.6 불변 객체로 만드세요

## 내용

### 식별자 가변성

객체가 불변하지 않다면 해당 객체의 식별자인 필드가 변하면서 관리가 어려워진다.

코드의 어느 부분에서 해당 객체가 변하고 현재 객체의 식별자가 어느 상태인지 추적하기가 매우 어렵다

### 식별 원자성

실패의 원자성은 완전한 상태의 객체를 가지거나 실패하거나 둘 중 하나만 가능하도록 한 것이다.

가변 객체의 경우 특정 메서드에서 변경하는 로직 중간에 예외가 일어나게 되면 일부 프로퍼티가 바뀐 상태로 절반만 변경이 된 상태가 되어버린다. 따라서 불완전한 객체가 생겨버린다. 하지만 불변 객체는 내부의 것을 수정하기보다 새로운 객체를 반환하기 때문에 원자성을 보장한다.

### 시간적 결합

시간적인 결합에 자유롭기 때문에 코드의 순서를 신경쓰면서 구현을 하지 않아도 되고 따라서 유지보수에 용이하다. 즉 불변객체는 인스턴스화와 초기화가 분리되지 않기 때문에 그 사이의 시간적인 결합을 제거할 수 있다.

### 부수효과 제거

누구나 해당 객체에 접근해서 변경할 수 있기 때문에 부수적인 오류가 발생할 가능성이 높다.

### Null 참조 없애기

불변객체는 인스턴스화와 초기화가 분리되지 않기 때문에 프로퍼티의 값이 Null로 할당될 수 없다. 따라서 해당 객체가 유효한 상태인지, 어떠한 상태인지 고민할 필요가 없기 때문에 유지보수에 용이하다.

만일 초기화되지 않은 프로퍼티를 가진 객체가 필요할 때는 다른 클래스를 생성해서 분해하도록 구현해야 한다.

### 스레드 안정성

불변객체는 여러 스레드에서 동시에 사용되면서 그 결과가 불변하다는 것을 보장할 수 있기 때문에 예측가능하도록 유지할 수 있다.

### 더 작고 더 단순한 객체

불변객체는 크게 만들기 어렵기 때문에 단순하고 작은 객체를 설계하게 된다. 왜냐하면 불변객체는 생성자 안에서만 프로퍼티를 초기화할 수 있기 때문에 지나치게 많은 프로퍼티를 만들어서 한꺼번에 초기화하지 않도록 구현한다.



## 의문

- 불변객체를 보장하기 위해서 새로운 객체를 생성하여 리턴하는 방식을 추천하고 있다. 그런데 그렇게 새로운객체를 리턴하면서 언젠가 가변인 부분이 있지 않을까?